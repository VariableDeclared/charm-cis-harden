# This file configures Charmcraft.
# See https://juju.is/docs/sdk/charmcraft-config for guidance.

# (Required)
# The charm package name, no spaces
# See https://juju.is/docs/sdk/naming#heading--naming-charms for guidance.
name: charm-cis-hardening


# (Required)
# The charm type, either 'charm' or 'bundle'.
type: charm


# (Recommended)
title: Charm Template
subordinate: true

# (Required)
summary: A very short one-line summary of the charm.


# (Required)
description: |
  A charm to enable per-application CIS hardening


# (Required for 'charm' type)
# A list of environments (OS version and architecture) where charms must be
# built on and run on.
bases:
  - build-on:
    - name: ubuntu
      channel: "22.04"
    run-on:
    - name: ubuntu
      channel: "22.04"
    - name: ubuntu
      channel: "24.04"

requires:
  juju-info:
    description: |
      Pair with parent application
    interface: juju-info
    scope: container
# (Optional) Configuration options for the charm
# This config section defines charm config options, and populates the Configure
# tab on Charmhub.
# More information on this section at https://juju.is/docs/sdk/charmcraft-yaml#heading--config
# General configuration documentation: https://juju.is/docs/sdk/config
config:
  options:
    # An example config option to customise the log level of the workload
    auto-harden:
      description: |
        Whether to start CIS hardening as soon as the charm passes the install hook.
        Defaults to false
      default: false
      type: boolean
    tailoring-file:
      description: |
        The XML file in base64 to apply to the application.
      type: string
      default: ""
    pre-hardening-script:
      description: |
        A Bash script to execute before the hardening
      type: string
      default: ""

actions:
  execute-cis:
    description: Start the CIS benchmark.
  execute-audit:
    description: Run audit with the tailoring file
